---
title: 'Task 3: Santa Barbara Urchins (SILVA)'
author: "German Silva"
date: "10/23/2021"
output: html_document
---
# Overview


**Data Source**: Reed, D. 2020. SBC LTER: Reef: Long-term experiment: Kelp removal: Urchin size frequency distribution ver 20. Environmental Data Initiative. https://doi.org/10.6073/pasta/5a1e9ef03aa47bd2225c0bb98a02a63b. 

```{r setup, message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)

# Attach packages
library(tidyverse)
library(here)
library(janitor)
library(kableExtra)
```

## Section 1: Size Comparisons between two species of sea urchins

### Data visualization of size distribution between two types of urchin
- Read in `urchin.csv`
- Clean names
- Separate names to obtain color column 
- Group by color 
- Create histogram of size distribution
  - reduce the number of bins
```{r}
urchins <- read_csv(here("data", "urchins.csv")) %>% # read in the data
  clean_names() %>% # clean names into lower_snakecase with clean_names()
  separate(col = common_name, # state which column we want split up
           into= c("color_type", "animal"), # state what you want the new columns to be
           sep = " ", # which separator is being used to make the columns
           remove = FALSE) %>%  # we are not removing the original column
  group_by(common_name) # create groups based on species common name

ggplot(urchins, aes(x = size, fill = common_name))+
  geom_histogram(bins = 10, alpha= 0.5, position = "identity") +
  facet_wrap(~ common_name) +
  scale_color_manual(values = c("darkorchid4", "darkred")) +
  scale_fill_manual(values = c("darkorchid4", "darkred")) +
  labs(x = "Urchin Diameter in cm",
       y = "Number of Observations",
       fill = "Type of Urchin \n(common name)",
       caption = "Fig. 1 Histograms showing the size distribution of two different species of urchin (red urchin and \npurple urchin). Purple urchin have smaller body sizes than red urchins and have less spread in \ndata than their red counterparts. Table 1 shows numeric values to be used for further comparison ") +
  ggtitle("Size Distribution of Red and Purple Urchins (SILVA)") +
  theme(plot.title = element_text(hjust = 0.5), plot.caption = element_text(hjust = 0))
```

### Descriptive Stats table
- Create a finalized stats table including:
  - mean
  - median
  - standard deviation
  - sample size
  
```{r}
urchins_stats <- urchins %>% 
  group_by(common_name, scientific_name) %>% 
  summarize(mean_diameter_cm = round(mean(size), 2),
            median_diameter_cm = median(size),
            sd_cm = round(sd(size), 2),
            sample_size = n())

kable(urchins_stats, caption = "**Table 1** Urchin Size Statistics Table")

```

# 

**Takeaway Points**: 
Red Urchins (*Mesocentrotus franciscanus*) are larger in size compared to Purple Urchins (*Strongylocentrotus purpuratus*) as show by the difference in mean (`r urchins_stats$mean_diameter_cm[2]` cm vs. `r urchins_stats$mean_diameter_cm[1]` cm) and median size (`r urchins_stats$median_diameter_cm[2]` cm vs. `r urchins_stats$median_diameter_cm[1]` cm). Actual mean difference is `r urchins_stats$mean_diameter_cm[2] - urchins_stats$mean_diameter_cm[1]` cm, or a % difference of `r round((urchins_stats$mean_diameter_cm[2] / urchins_stats$mean_diameter_cm[1]) * 100, 1) - 100` %. As shown by standard deviations (`r urchins_stats$sd_cm[2]` vs. `r urchins_stats$sd_cm[1]`), Red Urchins size distribution is more spread out compared to that of Purple Urchins.    
